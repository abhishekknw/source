<link rel="stylesheet" href="modules/pages/currentProposal/currentProposal.tmpl.css" />
<div><nav-bar></nav-bar></div>
  <div ng-if="isParentProposal == 'false'">
    <button class="btn btn-info active" ng-click="showHistory()">Back to Previous Page</button>
  </div>
<form name="proposalDetails" ng-hide="showEdit" class = "proposal-panel">
  <div class = "container">
      <div class="row">
        <div class="panel panel-default">
          <div class="panel-heading">
            <Label>Proposal Id:</Label><span>{{proposal.proposal_id}}</span>
            <Label class = "labels">Name of Proposal:</Label><span>{{proposal.name}}</span>
            <Label class = "labels">Tentative Cost:</Label><span>{{proposal.tentative_cost}} </span>
            <a class = "labels" ng-if="isParentProposal == 'true'" href="" ng-click="editInitialProposal(proposal.proposal_id)"><b>Edit Proposal</b></a>
            <a class = "labels" data-target="#invoiceModal" data-toggle="modal"><b>Enter Invoice Details</b></a>
          </div >
          <div class="row">
            <div class="col-md-10 center-heading"><label>Center Details:</label></div>
          </div>
          <div class="row">
            <div class="col-md-2 table-align" ng-repeat="header in centerheaders"><b>{{header.header}}</b></div>
          </div>
          <div ng-repeat="center in center_data">
            <div class="row">
              <div class="col-md-2 table-align">{{$index+1}}</div>
              <div class="col-md-2 table-align">{{center.center.center_name}}</div>
              <div class="col-md-2 table-align">{{center.center.area}}</div>
              <div class="col-md-2 table-align">{{center.center.subarea}}</div>
              <div class="col-md-2 table-align">{{center.center.radius}}</div>
            </div>
          </div>
         </div>
      </div>
  </div>
</form>
<div class="col-md-3" style="margin-left:83px;"><label>Select Advertising Location:</label>
  <select ng-model="current_center_id" ng-change="selectCenter(current_center_id)">
    <option ng-repeat="center_var in center_data" value="{{center_var.center.id}}">{{center_var.center.center_name}}</option>
  </select>
</div>
<!-- Start: Display supplier details for selected center-->
<div class = "container page-panel"  ng-if="current_center_id">
  <div class = "row">
    <div ng-if="current_center_data.filters.society_allowed">
      <div class = "col-md-12"><label class = "society-heading" ng-click="isSociety=!isSociety">Society Details</label></div>
      <div class="col-md-4 table-responsive" style="width: 1245px; height: 450px">
       <h5 class="panel-heading head" ng-click="isSociety=!isSociety"><b>Shortlisted Society Details</b></h5>
        <div uib-collapse="! isSociety">
          <table class="table table-bordered society">
            <thead>
              <tr>
               <th class="col-md-2 table-heading">Center</th>
               <th class="col-md-3 table-heading">Society</th>
               <th ng-if="current_center_data.societyFilters.inv_poster" class="col-md-0 table-heading">Poster Count</th>
               <th ng-if="current_center_data.societyFilters.inv_standee" class="col-md-0 table-heading">Standee Count</th>
               <th ng-if="current_center_data.societyFilters.inv_stall"  class="col-md-0 table-heading">Stall Count</th>
               <th ng-if="current_center_data.societyFilters.inv_flier" class="col-md-0 table-heading">Flyer Count</th>
               <th class = "col-md-4">Status</th>
               <th class = "col-md-4">Action</th>
              </tr>
            </thead>
            <tbody ng-repeat=" supplier in current_center_data.suppliers['RS']">
              <tr ng-if="supplier.status != 'R'">
                <td>{{current_center_data.center.center_name}}</td>
                <td>{{supplier.society_name}}</td>
                <td ng-if="current_center_data.societyFilters.inv_poster">{{supplier.tower_count}}</td>
                <td ng-if="current_center_data.societyFilters.inv_standee">{{supplier.total_standee_count}}</td>
                <td ng-if="current_center_data.societyFilters.inv_stall">{{supplier.total_stall_count}}</td>
                <td ng-if="current_center_data.societyFilters.inv_flier">{{supplier.flat_count}}</td>
                <td ng-if="supplier.status == 'S'">Shortlisted</td>
                <td ng-if="supplier.status == 'B'">Buffer</td>
                <td>
                  <a ng-href="" ng-if="supplier.status == 'S'" ng-click="setSupplierStatus(supplier,'B')">Buffer</a>
                  <a ng-href="" ng-if="supplier.status == 'B'" ng-click="setSupplierStatus(supplier,'S')">Shortlist</a>
                  <a ng-href="" ng-if="supplier.status != 'R'" ng-click="setSupplierStatus(supplier,'R')">Remove</a>
                </td>
              </tr>
            </tbody>
          </table>
        </div><!-- uib collapse div ends here-->
        <h5 class="panel-heading head" ng-click="isSociety=!isSociety"><b>Details of Removed Societies</b></h5>
        <div uib-collapse="! isSociety">
          <table class="table table-bordered society">
           <thead>
             <tr>
               <th class="col-md-2 table-heading">Center</th>
               <th class="col-md-3 table-heading">Society</th>
               <th ng-if="current_center_data.societyFilters.inv_poster" class="col-md-0 table-heading">Poster Count</th>
               <th ng-if="current_center_data.societyFilters.inv_standee" class="col-md-0 table-heading">Standee Count</th>
               <th ng-if="current_center_data.societyFilters.inv_stall"  class="col-md-0 table-heading">Stall Count</th>
               <th ng-if="current_center_data.societyFilters.inv_flier" class="col-md-0 table-heading">Flyer Count</th>
               <th class = "col-md-4">Action</th>
             </tr>
           </thead>
           <tbody ng-repeat=" supplier in current_center_data.suppliers['RS']">
             <tr ng-if="supplier.status == 'R'">
               <td>{{current_center_data.center.center_name}}</td>
               <td>{{supplier.society_name}}</td>
               <td ng-if="current_center_data.societyFilters.inv_poster">{{supplier.tower_count}}</td>
               <td ng-if="current_center_data.societyFilters.inv_standee">{{supplier.total_standee_count}}</td>
               <td ng-if="current_center_data.societyFilters.inv_stall">{{supplier.total_stall_count}}</td>
               <td ng-if="current_center_data.societyFilters.inv_flier">{{supplier.flat_count}}</td>
               <td>
                <button class="btn btn-danger active" ng-click="setSupplierStatus(supplier,'S')">Shortlist</button>
               </td>
             </tr>
           </tbody>
          </table>
          </div>
      </div>
    </div>
  </div>
</div>
<!-- End: Display supplier details for selected center-->
<div class = "col-md-12">
  <button class="btn btn-danger update-button" ng-click="updateProposal()">Update Details</button>
</div>

<!--Start: Code for Invoice Modal Window -->
<div id="invoiceModal" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title">Invoice Details</h4>
        <hr/>
        <div class = "modal-body" style = "height: 300px;">
          <div class = "row form-group">
            <span class="col-md-3"><label>Invoice Number</label></span>
            <span class="col-md-3">
              <input type = "text" name="invoicenumber" id="invoicenumber" class = "form-control">
            </span>
          </div>
          <div class="row form-group">
            <span class="col-md-3"><label>Start Date:</label></span>
            <span class="col-md-3">
              <input type="text" ng-model="model.tentative.start_date" class="form-control" uib-datepicker-popup="{{format}}" is-open="popup1" min-date="today" datepicker-options="dateOptions" close-text="Close" alt-input-formats="altInputFormats" />
            </span>
            <span class="input-group-btn">
              <button type="button" class="btn btn-default" ng-click="popup1 = true"><i class="glyphicon glyphicon-calendar"></i></button>
            </span>
            <span class="col-md-3"><label>End Date:</label></span>
            <span class="col-md-3">
              <input type="text" ng-model="model.tentative.end_date" class="form-control" uib-datepicker-popup="{{format}}" is-open="popup2" min-date="key.start_date" datepicker-options="dateOptions" close-text="Close" />
            </span>
            <span class="input-group-btn">
              <button type="button" class="btn btn-default" ng-click="popup2 = true"><i class="glyphicon glyphicon-calendar"></i></button>
            </span>
          </div>
          <button class="btn btn-danger active notify" ng-click="saveInvoiceDetails()">Save</button>
        </div>
      </div>
    </div>
  </div>
</div>
<!--End: Code for Invoice Modal Window -->

<div><footer-bar></footer-bar></div>