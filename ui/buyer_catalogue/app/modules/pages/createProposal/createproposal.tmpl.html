<link rel="stylesheet" href="modules/pages/createProposal/createproposal.tmpl.css" />
<link rel="stylesheet" href="modules/common/loadingicon/loading-spinner.tmpl.css"/>
<div><nav-bar></nav-bar></div>
<div ng-if="errormsg"><h3>{{errormsg}}</h3></div>
  <div class="page-container">
  	<div>
    	<span style="color:red;margin-left:25%;font-size:18px;">{{errorMsg}}</span><br>
    	<span style="color:blue;margin-left:28%;font-size:18px;">{{successMsg}}</span>
  	</div>
    <!-- <back-Button></back-Button> -->
    <div class="breadcrumb" ncy-breadcrumb></div>
    <div ng-loading="loading"></div> <!--For displaying loading icon-->
  	<form name="proposal">
  		<div class="panel panel-default business-panel">
        <h3 class="panel-heading alignment">Initial Requirement Gathering</h3>
  			<div class="table">
  				<div class="row">
  					<div class="col-md-3"><label class="spacing">Name of Proposal</label></div>
  					<div class="col-md-3"><input type="text" ng-model="model.name" class="form-control spacing" required></div>
  				</div>
  				<div class="row">
  					<div class="col-md-3"><label class="spacing">Tentative Budget</label></div>
  					<div class="col-md-3"><input type="number" ng-model="model.tentative_cost" class="form-control spacing"></div>
  				</div>
          <button class="btn btn-danger spacing pull-left addButton" ng-click="addCenter()">Add Center</button>
  			</div>
  		</div>
  	</form>

    <form name="centerDetail">
    	<div class="table-responsive panel panel-default business-panel">
    		<table class="table table-bordered">
    			<thead>
    				<tr>
              <th class="alignment" ng-repeat="header in proposalheaders"><b>{{header.header}}</b></div>
    				</tr>
    			</thead>
    			<tbody ng-repeat="center in model.centers track by $index">
    				<tr>
    					<td>
                <input type="text" ng-if="center.isEditProposal" ng-model="center.center.center_name" class="form-control spacing" required>
                <input type="text" ng-if="!center.isEditProposal" ng-model="center.center.center_name" class="form-control spacing" readonly>
              </td>
    					<td><input type="text" ng-if="center.isEditProposal" ng-model="center.center.address" class="form-control spacing" required>
                  <input type="text" ng-if="!center.isEditProposal" ng-model="center.center.address" class="form-control spacing" readonly>
              </td>
              <td>
                <select ng-if="center.isEditProposal" name="city" class="form-control input-size" ng-change="get_areas(center.city,$index)" ng-model="center.city" required>
                  <option value="">Select City</option>
                  <option  ng-repeat="city in cities" value="{{city.id}}" required>{{city.city_name}}</option>
                </select>
                <input type="text" ng-if="!center.isEditProposal" ng-model="center.center.city" class="form-control spacing" readonly>
              </td>
              <td>
                <select ng-if="center.isEditProposal" name="areas" class="form-control input-size" ng-change="get_sub_areas(center.area,$index)" ng-model="center.area" required>
                  <option value="">Select Area</option>
                  <option  ng-repeat="area in areas[$index]" value="{{area.id}}" required>{{area.label}}</option>
                </select>
                <input type="text" ng-if="!center.isEditProposal" ng-model="center.center.area" class="form-control spacing" readonly>
              </td>
              <td>
                <select ng-if="center.isEditProposal" name="subareas" class="form-control input-size" ng-change="" ng-model="center.center.subarea" required>
                  <option value="">Select SubArea</option>
                  <option  ng-repeat="subarea in sub_areas[$index]" value="{{subarea.subarea_name}}" required>{{subarea.subarea_name}}</option>
                </select>
                <input type="text" ng-if="!center.isEditProposal" ng-model="center.center.subarea" class="form-control spacing" readonly>
              </td>
              <td><input type="number" ng-if="center.isEditProposal" ng-model="center.center.pincode" class="form-control spacing col-width" required>
                <input type="number" ng-if="!center.isEditProposal" ng-model="center.center.pincode"  class="form-control spacing" readonly>
              </td>
    					<td><input type="number" name = "radius" ng-model="center.center.radius" class="form-control spacing col-width" required></td>
    					<td>
                <div ng-repeat="supplier in center.suppliers">
                  <input type="checkbox"  ng-model = "supplier.selected" ng-click="checkSpace(supplier,center)">{{supplier.name}}
                </div>
                <!-- <input type="checkbox"  ng-click="checkSpace('CP',center)">Corporate Parks -->
              </td>
    					<td><button class="btn btn-danger spacing" ng-click="removeCenter($index)">Remove Center</button></td>
    				</tr>
    			</tbody>
    		</table>
    		<button class="btn btn-danger spacing" ng-click="submit()" ng-disabled="proposal.$invalid || centerDetail.$invalid" ng-loading="loadingSpinner">Submit</button>
    	</div>
    </form>

<div><footer-bar></footer-bar></div>
